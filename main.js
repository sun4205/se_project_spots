!function(){"use strict";const e={formSelector:".modal__form",inputSelector:".modal__input",submitButtonSelector:".modal__submit-btn",inactiveButtonClass:"modal__submit-btn_disabled",inputErrorClass:"modal__input_type_error",errorClass:"modal__input_type_error"},t=(e,t)=>{e.disabled=!0,e.classList.add(t.inactiveButtonClass)},r=(e,r,o)=>{(e=>e.some((e=>!e.validity.valid)))(e)?t(r,o):((e,t)=>{e.disabled=!1,e.classList.remove(t.inactiveButtonClass)})(r,o)},o=(e,t,r)=>{e.querySelector(`#${t.id}-error`).textContent="",t.classList.remove(r.inputErrorClass)};function n(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"save",o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"saving...";t?(e.textContent=o,e.disabled=!0):(e.textContent=r,e.disabled=!1)}console.log([{name:"Val Thorens",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/spots/1-photo-by-moritz-feldmann-from-pexels.jpg"},{name:"Restaurant terrace",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/spots/2-photo-by-ceiline-from-pexels.jpg"},{name:"An outdoor cafe",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/spots/3-photo-by-tubanur-dogan-from-pexels.jpg"},{name:"A very long bridge, over the forest and through the trees",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/spots/4-photo-by-maurice-laschet-from-pexels.jpg"},{name:"Tunnel with morning light",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/spots/5-photo-by-van-anh-nguyen-from-pexels.jpg"},{name:"Mountain house",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/spots/6-photo-by-moritz-feldmann-from-pexels.jpg"},{name:"Golden Gate bridge",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/spots/7-photo-by-griffin-wooldridge-from-pexels.jpg"}]);const a=new class{constructor(e){let{baseUrl:t,headers:r}=e;this._baseUrl=t,this._headers=r}getAppInfo(){return Promise.all([this.getInitialCards(),this.getUserInfo()])}getInitialCards(){return fetch(`${this._baseUrl}/cards`,{headers:this._headers}).then((e=>{if(e.ok)return e.json();Promise.reject(`Error: ${e.status}`)}))}getUserInfo(){return fetch(`${this._baseUrl}/users/me`,{headers:this._headers}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`)))}addNewCard(e){let{name:t,link:r}=e;return fetch(`${this._baseUrl}/cards`,{method:"POST",headers:this._headers,body:JSON.stringify({name:t,link:r})}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`)))}editUserInfo(e){let{name:t,about:r}=e;return fetch(`${this._baseUrl}/users/me`,{method:"PATCH",headers:this._headers,body:JSON.stringify({name:t,about:r})}).then((e=>{if(e.ok)return e.json();Promise.reject(`Error: ${e.status}`)}))}editAvatarInfo(e){return fetch(`${this._baseUrl}/users/me/avatar`,{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:e})}).then((e=>{if(e.ok)return e.json();Promise.reject(`Error: ${e.status}`)}))}deleteCard(e){return fetch(`${this._baseUrl}/cards/${e}`,{method:"DELETE",headers:this._headers}).then((e=>{if(e.ok)return e.json();Promise.reject(`Error: ${e.status}`)}))}changeLikeStatus(e,t){return fetch(`${this._baseUrl}/cards/${e}/likes`,{method:t?"DELETE":"PUT",headers:this._headers}).then((e=>{if(e.ok)return e.json();Promise.reject(`Error: ${e.status}`)}))}}({baseUrl:"https://around-api.en.tripleten-services.com/v1",headers:{authorization:"2d4b9f7c-b9f4-4e18-86c3-caa0e9c274de","Content-Type":"application/json"}});a.getAppInfo().then((e=>{let[t,r]=e;t.forEach((e=>{const t=N(e);U.prepend(t)})),d.textContent=r.name,u.textContent=r.about,document.querySelector(".profile__avatar").src=r.avatar})).catch(console.error);const s=document.forms["profile-form"],l=document.forms["card-form"],c=document.querySelector(".profile__edit-btn"),i=document.querySelector(".profile__add-btn"),d=document.querySelector(".profile__name"),u=document.querySelector(".profile__description"),m=l.querySelector(".modal__submit-btn"),_=document.querySelector(".modal__submit-btn--cancel"),h=document.querySelector("#modal-edit"),p=(h.querySelector(".modal__close-btn"),h.querySelector("#modal-profile-name-input")),f=h.querySelector("#modal-profile-description-input"),v=document.querySelector("#modal__add-card"),y=(v.querySelector(".modal__close-btn"),v.querySelector("#modal__add-card-name-input")),b=v.querySelector("#modal__add-card-link-input"),S=document.getElementById("modal-avatar-edit"),g=document.querySelector(".profile__avatar"),k=document.querySelector(".profile__avatar-btn"),E=S.querySelector(".modal__form"),q=S.querySelector("#modal-avatar-description-input"),L=(S.querySelector(".modal__submit-btn"),S.querySelector(".modal__close-btn"),document.querySelector("#modal__delete")),C=L.querySelector(".modal__form"),w=document.querySelector("#modal__preview"),j=w.querySelector(".modal__image"),x=w.querySelector(".modal__caption"),$=(w.querySelector(".modal__close-btn"),document.querySelector("#card-template")),U=document.querySelector(".cards__list");let A,P,I=null;function z(e){"Escape"===e.key&&I&&D(I)}function T(e){I&&e.target===I&&D(I)}function B(e){e.classList.add("modal_opened"),I=e,document.addEventListener("keydown",z),document.addEventListener("click",T),console.log("Modal opened and Escape key listener added")}function D(e){e.classList.remove("modal_opened"),I===e&&(I=null),document.removeEventListener("keydown",z),document.removeEventListener("click",T),console.log("Modal closed and Escape key listener removed")}function N(e){const t=$.content.querySelector(".card").cloneNode(!0),r=t.querySelector(".card__title"),o=t.querySelector(".card__image"),n=t.querySelector(".card__like-btn"),s=t.querySelector(".card__delete-btn");return r.textContent=e.name,o.src=e.link,o.alt=e.name,e.isLiked&&n.classList.add("card__like-btn_liked"),n.addEventListener("click",(function(t,r){const o=n.classList.contains("card__like-btn_liked");a.changeLikeStatus(e._id,o).then((e=>{n.classList.toggle("card__like-btn_liked",e.isLiked)})).catch(console.error)})),o.addEventListener("click",(()=>{B(w),j.src=e.link,x.textContent=e.name,j.alt=e.name})),s.addEventListener("click",(r=>{!function(e,t){A=e,P=t,B(L)}(t,e._id)})),t}var M;document.querySelectorAll(".modal__close-btn").forEach((e=>{const t=e.closest(".modal");e.addEventListener("click",(()=>D(t)))})),c.addEventListener("click",(()=>{var t,r;p.value=d.textContent,f.value=u.textContent,t=s,r=e,[p,f].forEach((e=>{o(t,e,r)})),B(h)})),i.addEventListener("click",(()=>{p.value=d.textContent,f.value=u.textContent,B(v)})),k.addEventListener("click",(()=>{B(S)})),E.addEventListener("submit",(function(e){e.preventDefault();const t=e.submitter;n(t,!0),a.editAvatarInfo(q.value).then((e=>{console.log(e),e.avatar?(g.src=e.avatar,g.alt="Updated Avatar"):console.error("Avatar URL not found in the response"),D(S),E.reset()})).catch(console.error).finally((()=>{n(t,!1)}))})),s.addEventListener("submit",(function(e){e.preventDefault();const t=e.submitter;n(t,!0),a.editUserInfo({name:p.value,about:f.value}).then((e=>{d.textContent=e.name,u.textContent=e.about,D(h)})).catch(console.error).finally((()=>{n(t,!1)}))})),l.addEventListener("submit",(function(r){r.preventDefault();const o={name:y.value,link:b.value},s=r.submitter;n(s,!0),a.addNewCard(o).then((o=>{const n=N(o);U.prepend(n),r.target.reset(),t(m,e),D(v)})).catch(console.error).finally((()=>{n(s,!1)}))})),C.addEventListener("submit",(function(e){e.preventDefault();const t=e.submitter;n(t,!0,"delete","deleting..."),a.deleteCard(P).then((()=>{A.remove(),A=null,P=null,D(L)})).catch(console.error).finally((()=>{n(t,!1,"delete")}))})),_.addEventListener("click",(()=>D(L))),M=e,Array.from(document.querySelectorAll(M.formSelector)).forEach((e=>{((e,n)=>{const a=Array.from(e.querySelectorAll(n.inputSelector)),s=e.querySelector(n.submitButtonSelector);r(a,s,n),a.forEach((t=>{t.addEventListener("input",(()=>{((e,t,r)=>{t.validity.valid?o(e,t,r):((e,t,r,o)=>{e.querySelector(`#${t.id}-error`).textContent=r,t.classList.add(o.inputErrorClass)})(e,t,t.validationMessage,r)})(e,t,n),r(a,s,n)}))})),e.addEventListener("reset",(()=>{t(s,n)}))})(e,M)}))}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUFtQnZKLEVBRzdELEVBK0NJb0osQ0FBbUJ0SSxFQUFRcUksRUFBY25KLEdBQ3pDSSxFQUFrQkMsRUFBVzZJLEVBQWVsSixFQUFPLEdBQ25ELElBRUpjLEVBQU9zRyxpQkFBaUIsU0FBUyxLQUMvQnRILEVBQWNvSixFQUFlbEosRUFBTyxHQUNwQyxFQU1BaUosQ0FBaUJuSSxFQUFRZCxFQUFPLEciLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9zZV9wcm9qZWN0X3Nwb3RzLy4vc3JjL3NjcmlwdHMvdmFsaWRhdGlvbi5qcyIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X3Nwb3RzLy4vc3JjL3V0aWxzL2hlbHBlcnMuanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9zcG90cy8uL3NyYy9wYWdlcy9pbmRleC5qcyIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X3Nwb3RzLy4vc3JjL3V0aWxzL0FwaS5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgY29uc3Qgc2V0dGluZ3MgPSB7XHJcbiAgZm9ybVNlbGVjdG9yOiBcIi5tb2RhbF9fZm9ybVwiLFxyXG4gIGlucHV0U2VsZWN0b3I6IFwiLm1vZGFsX19pbnB1dFwiLFxyXG4gIHN1Ym1pdEJ1dHRvblNlbGVjdG9yOiBcIi5tb2RhbF9fc3VibWl0LWJ0blwiLFxyXG4gIGluYWN0aXZlQnV0dG9uQ2xhc3M6IFwibW9kYWxfX3N1Ym1pdC1idG5fZGlzYWJsZWRcIixcclxuICBpbnB1dEVycm9yQ2xhc3M6IFwibW9kYWxfX2lucHV0X3R5cGVfZXJyb3JcIixcclxuICBlcnJvckNsYXNzOiBcIm1vZGFsX19pbnB1dF90eXBlX2Vycm9yXCIsXHJcbn07XHJcblxyXG5jb25zdCBzaG93SW5wdXRFcnJvciA9IChmb3JtRWwsIGlucHV0RWwsIGVycm9yTXNnLCBjb25maWcpID0+IHtcclxuICBjb25zdCBlcnJvck1zZ0VsID0gZm9ybUVsLnF1ZXJ5U2VsZWN0b3IoYCMke2lucHV0RWwuaWR9LWVycm9yYCk7XHJcbiAgZXJyb3JNc2dFbC50ZXh0Q29udGVudCA9IGVycm9yTXNnO1xyXG4gIGlucHV0RWwuY2xhc3NMaXN0LmFkZChjb25maWcuaW5wdXRFcnJvckNsYXNzKTtcclxufTtcclxuXHJcbmNvbnN0IGNoZWNrSW5wdXRWYWxpZGl0eSA9IChmb3JtRWwsIGlucHV0RWwsIGNvbmZpZykgPT4ge1xyXG4gIGlmICghaW5wdXRFbC52YWxpZGl0eS52YWxpZCkge1xyXG4gICAgc2hvd0lucHV0RXJyb3IoZm9ybUVsLCBpbnB1dEVsLCBpbnB1dEVsLnZhbGlkYXRpb25NZXNzYWdlLCBjb25maWcpO1xyXG4gIH0gZWxzZSB7XHJcbiAgICBoaWRlSW5wdXRFcnJvcihmb3JtRWwsIGlucHV0RWwsIGNvbmZpZyk7XHJcbiAgfVxyXG59O1xyXG5cclxuY29uc3QgaGFzSW52YWxpZElucHV0ID0gKGlucHV0TGlzdCkgPT4ge1xyXG4gIHJldHVybiBpbnB1dExpc3Quc29tZSgoaW5wdXQpID0+IHtcclxuICAgIHJldHVybiAhaW5wdXQudmFsaWRpdHkudmFsaWQ7XHJcbiAgfSk7XHJcbn07XHJcblxyXG5leHBvcnQgY29uc3QgZGlzYWJsZUJ1dHRvbiA9IChidXR0b25FbCwgY29uZmlnKSA9PiB7XHJcbiAgYnV0dG9uRWwuZGlzYWJsZWQgPSB0cnVlO1xyXG4gIGJ1dHRvbkVsLmNsYXNzTGlzdC5hZGQoY29uZmlnLmluYWN0aXZlQnV0dG9uQ2xhc3MpO1xyXG59O1xyXG5cclxuY29uc3QgZW5hYmxlQnV0dG9uID0gKGJ1dHRvbkVsLCBjb25maWcpID0+IHtcclxuICBidXR0b25FbC5kaXNhYmxlZCA9IGZhbHNlO1xyXG4gIGJ1dHRvbkVsLmNsYXNzTGlzdC5yZW1vdmUoY29uZmlnLmluYWN0aXZlQnV0dG9uQ2xhc3MpO1xyXG59O1xyXG5cclxuY29uc3QgdG9nZ2xlQnV0dG9uU3RhdGUgPSAoaW5wdXRMaXN0LCBidXR0b25FbCwgY29uZmlnKSA9PiB7XHJcbiAgaWYgKGhhc0ludmFsaWRJbnB1dChpbnB1dExpc3QpKSB7XHJcbiAgICBkaXNhYmxlQnV0dG9uKGJ1dHRvbkVsLCBjb25maWcpO1xyXG4gIH0gZWxzZSB7XHJcbiAgICBlbmFibGVCdXR0b24oYnV0dG9uRWwsIGNvbmZpZyk7XHJcbiAgfVxyXG59O1xyXG5cclxuZXhwb3J0IGNvbnN0IHJlc2V0VmFsaWRhdGlvbiA9IChmb3JtRWwsIGlucHV0TGlzdCwgY29uZmlnKSA9PiB7XHJcbiAgaW5wdXRMaXN0LmZvckVhY2goKGlucHV0KSA9PiB7XHJcbiAgICBoaWRlSW5wdXRFcnJvcihmb3JtRWwsIGlucHV0LCBjb25maWcpO1xyXG4gIH0pO1xyXG59O1xyXG5cclxuY29uc3QgaGlkZUlucHV0RXJyb3IgPSAoZm9ybUVsLCBpbnB1dEVsLCBjb25maWcpID0+IHtcclxuICBjb25zdCBlcnJvck1zZ0VsID0gZm9ybUVsLnF1ZXJ5U2VsZWN0b3IoYCMke2lucHV0RWwuaWR9LWVycm9yYCk7XHJcbiAgZXJyb3JNc2dFbC50ZXh0Q29udGVudCA9IFwiXCI7XHJcbiAgaW5wdXRFbC5jbGFzc0xpc3QucmVtb3ZlKGNvbmZpZy5pbnB1dEVycm9yQ2xhc3MpO1xyXG59O1xyXG5cclxuY29uc3Qgc2V0RXZlbnRMaXN0bmVycyA9IChmb3JtRWwsIGNvbmZpZykgPT4ge1xyXG4gIGNvbnN0IGlucHV0TGlzdCA9IEFycmF5LmZyb20oZm9ybUVsLnF1ZXJ5U2VsZWN0b3JBbGwoY29uZmlnLmlucHV0U2VsZWN0b3IpKTtcclxuICBjb25zdCBidXR0b25FbGVtZW50ID0gZm9ybUVsLnF1ZXJ5U2VsZWN0b3IoY29uZmlnLnN1Ym1pdEJ1dHRvblNlbGVjdG9yKTtcclxuXHJcbiAgdG9nZ2xlQnV0dG9uU3RhdGUoaW5wdXRMaXN0LCBidXR0b25FbGVtZW50LCBjb25maWcpO1xyXG5cclxuICBpbnB1dExpc3QuZm9yRWFjaCgoaW5wdXRFbGVtZW50KSA9PiB7XHJcbiAgICBpbnB1dEVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImlucHV0XCIsICgpID0+IHtcclxuICAgICAgY2hlY2tJbnB1dFZhbGlkaXR5KGZvcm1FbCwgaW5wdXRFbGVtZW50LCBjb25maWcpO1xyXG4gICAgICB0b2dnbGVCdXR0b25TdGF0ZShpbnB1dExpc3QsIGJ1dHRvbkVsZW1lbnQsIGNvbmZpZyk7XHJcbiAgICB9KTtcclxuICB9KTtcclxuICBmb3JtRWwuYWRkRXZlbnRMaXN0ZW5lcihcInJlc2V0XCIsICgpID0+IHtcclxuICAgIGRpc2FibGVCdXR0b24oYnV0dG9uRWxlbWVudCwgY29uZmlnKTtcclxuICB9KTtcclxufTtcclxuXHJcbmV4cG9ydCBjb25zdCBlbmFibGVWYWxpZGF0aW9uID0gKGNvbmZpZykgPT4ge1xyXG4gIGNvbnN0IGZvcm1MaXN0ID0gQXJyYXkuZnJvbShkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKGNvbmZpZy5mb3JtU2VsZWN0b3IpKTtcclxuICBmb3JtTGlzdC5mb3JFYWNoKChmb3JtRWwpID0+IHtcclxuICAgIHNldEV2ZW50TGlzdG5lcnMoZm9ybUVsLCBjb25maWcpO1xyXG4gIH0pO1xyXG59O1xyXG4iLCJleHBvcnQgZnVuY3Rpb24gc2V0QnV0dG9uVGV4dChcclxuICBidG4sXHJcbiAgaXNMb2FkaW5nLFxyXG4gIGRlZmF1bHRUZXh0ID0gXCJzYXZlXCIsXHJcbiAgbG9hZGluZ1RleHQgPSBcInNhdmluZy4uLlwiXHJcbikge1xyXG4gIGlmIChpc0xvYWRpbmcpIHtcclxuICAgIGJ0bi50ZXh0Q29udGVudCA9IGxvYWRpbmdUZXh0O1xyXG4gICAgYnRuLmRpc2FibGVkID0gdHJ1ZTtcclxuICB9IGVsc2Uge1xyXG4gICAgYnRuLnRleHRDb250ZW50ID0gZGVmYXVsdFRleHQ7XHJcbiAgICBidG4uZGlzYWJsZWQgPSBmYWxzZTtcclxuICB9XHJcbn1cclxuIiwiaW1wb3J0IFwiLi9pbmRleC5jc3NcIjtcclxuaW1wb3J0IHtcclxuICBlbmFibGVWYWxpZGF0aW9uLFxyXG4gIHNldHRpbmdzLFxyXG4gIHJlc2V0VmFsaWRhdGlvbixcclxuICBkaXNhYmxlQnV0dG9uLFxyXG59IGZyb20gXCIuLi9zY3JpcHRzL3ZhbGlkYXRpb25cIjtcclxuaW1wb3J0IEFwaSBmcm9tIFwiLi4vdXRpbHMvQXBpLmpzXCI7XHJcbmltcG9ydCB7IHNldEJ1dHRvblRleHQgfSBmcm9tIFwiLi4vdXRpbHMvaGVscGVycy5qc1wiO1xyXG5cclxuY29uc3QgaW5pdGlhbENhcmRzID0gW1xyXG4gIHtcclxuICAgIG5hbWU6IFwiVmFsIFRob3JlbnNcIixcclxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9zcG90cy8xLXBob3RvLWJ5LW1vcml0ei1mZWxkbWFubi1mcm9tLXBleGVscy5qcGdcIixcclxuICB9LFxyXG4gIHtcclxuICAgIG5hbWU6IFwiUmVzdGF1cmFudCB0ZXJyYWNlXCIsXHJcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvc3BvdHMvMi1waG90by1ieS1jZWlsaW5lLWZyb20tcGV4ZWxzLmpwZ1wiLFxyXG4gIH0sXHJcbiAge1xyXG4gICAgbmFtZTogXCJBbiBvdXRkb29yIGNhZmVcIixcclxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9zcG90cy8zLXBob3RvLWJ5LXR1YmFudXItZG9nYW4tZnJvbS1wZXhlbHMuanBnXCIsXHJcbiAgfSxcclxuICB7XHJcbiAgICBuYW1lOiBcIkEgdmVyeSBsb25nIGJyaWRnZSwgb3ZlciB0aGUgZm9yZXN0IGFuZCB0aHJvdWdoIHRoZSB0cmVlc1wiLFxyXG4gICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL3Nwb3RzLzQtcGhvdG8tYnktbWF1cmljZS1sYXNjaGV0LWZyb20tcGV4ZWxzLmpwZ1wiLFxyXG4gIH0sXHJcbiAge1xyXG4gICAgbmFtZTogXCJUdW5uZWwgd2l0aCBtb3JuaW5nIGxpZ2h0XCIsXHJcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvc3BvdHMvNS1waG90by1ieS12YW4tYW5oLW5ndXllbi1mcm9tLXBleGVscy5qcGdcIixcclxuICB9LFxyXG4gIHtcclxuICAgIG5hbWU6IFwiTW91bnRhaW4gaG91c2VcIixcclxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9zcG90cy82LXBob3RvLWJ5LW1vcml0ei1mZWxkbWFubi1mcm9tLXBleGVscy5qcGdcIixcclxuICB9LFxyXG4gIHtcclxuICAgIG5hbWU6IFwiR29sZGVuIEdhdGUgYnJpZGdlXCIsXHJcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvc3BvdHMvNy1waG90by1ieS1ncmlmZmluLXdvb2xkcmlkZ2UtZnJvbS1wZXhlbHMuanBnXCIsXHJcbiAgfSxcclxuXTtcclxuXHJcbmNvbnNvbGUubG9nKGluaXRpYWxDYXJkcyk7XHJcblxyXG5jb25zdCBhcGkgPSBuZXcgQXBpKHtcclxuICBiYXNlVXJsOiBcImh0dHBzOi8vYXJvdW5kLWFwaS5lbi50cmlwbGV0ZW4tc2VydmljZXMuY29tL3YxXCIsXHJcbiAgaGVhZGVyczoge1xyXG4gICAgYXV0aG9yaXphdGlvbjogXCIyZDRiOWY3Yy1iOWY0LTRlMTgtODZjMy1jYWEwZTljMjc0ZGVcIixcclxuICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiLFxyXG4gIH0sXHJcbn0pO1xyXG5cclxuYXBpXHJcbiAgLmdldEFwcEluZm8oKVxyXG4gIC50aGVuKChbY2FyZHMsIHVzZXJJbmZvXSkgPT4ge1xyXG4gICAgY2FyZHMuZm9yRWFjaCgoY2FyZCkgPT4ge1xyXG4gICAgICBjb25zdCBjYXJkRWxlbWVudCA9IGdldENhcmRFbGVtZW50KGNhcmQpO1xyXG4gICAgICBjYXJkc0xpc3QucHJlcGVuZChjYXJkRWxlbWVudCk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBwcm9maWxlTmFtZS50ZXh0Q29udGVudCA9IHVzZXJJbmZvLm5hbWU7XHJcbiAgICBwcm9maWxlRGVzY3JpcHRpb24udGV4dENvbnRlbnQgPSB1c2VySW5mby5hYm91dDtcclxuXHJcbiAgICBjb25zdCBhdmF0YXJJbWFnZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fYXZhdGFyXCIpO1xyXG4gICAgYXZhdGFySW1hZ2Uuc3JjID0gdXNlckluZm8uYXZhdGFyO1xyXG4gIH0pXHJcbiAgLmNhdGNoKGNvbnNvbGUuZXJyb3IpO1xyXG5cclxuY29uc3QgcHJvZmlsZUZvcm0gPSBkb2N1bWVudC5mb3Jtc1tcInByb2ZpbGUtZm9ybVwiXTtcclxuY29uc3QgY2FyZEZvcm0gPSBkb2N1bWVudC5mb3Jtc1tcImNhcmQtZm9ybVwiXTtcclxuY29uc3QgcHJvZmlsZUVkaXRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2VkaXQtYnRuXCIpO1xyXG5jb25zdCBjYXJkTW9kYWxidG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2FkZC1idG5cIik7XHJcbmNvbnN0IHByb2ZpbGVOYW1lID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19uYW1lXCIpO1xyXG5jb25zdCBwcm9maWxlRGVzY3JpcHRpb24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2Rlc2NyaXB0aW9uXCIpO1xyXG5jb25zdCBjYXJkU3VibWl0QnRuID0gY2FyZEZvcm0ucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fc3VibWl0LWJ0blwiKTtcclxuY29uc3QgY2FuY2VsQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fc3VibWl0LWJ0bi0tY2FuY2VsXCIpO1xyXG5cclxuY29uc3QgZWRpdE1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNtb2RhbC1lZGl0XCIpO1xyXG5cclxuY29uc3QgZWRpdE1vZGFsQ2xvc2VCdG4gPSBlZGl0TW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fY2xvc2UtYnRuXCIpO1xyXG5jb25zdCBlZGl0TW9kYWxOYW1lSW5wdXQgPSBlZGl0TW9kYWwucXVlcnlTZWxlY3RvcihcIiNtb2RhbC1wcm9maWxlLW5hbWUtaW5wdXRcIik7XHJcbmNvbnN0IGVkaXRNb2RhbERlc2NyaXB0aW9uSW5wdXQgPSBlZGl0TW9kYWwucXVlcnlTZWxlY3RvcihcclxuICBcIiNtb2RhbC1wcm9maWxlLWRlc2NyaXB0aW9uLWlucHV0XCJcclxuKTtcclxuXHJcbmNvbnN0IGNhcmRNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjbW9kYWxfX2FkZC1jYXJkXCIpO1xyXG5cclxuY29uc3QgY2FyZE1vZGFsQ2xvc2VidG4gPSBjYXJkTW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fY2xvc2UtYnRuXCIpO1xyXG5jb25zdCBjYXJkTmFtZUlucHV0ID0gY2FyZE1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIjbW9kYWxfX2FkZC1jYXJkLW5hbWUtaW5wdXRcIik7XHJcbmNvbnN0IGNhcmRMaW5rSW5wdXQgPSBjYXJkTW9kYWwucXVlcnlTZWxlY3RvcihcIiNtb2RhbF9fYWRkLWNhcmQtbGluay1pbnB1dFwiKTtcclxuXHJcbmNvbnN0IGF2YXRhck1vZGFsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJtb2RhbC1hdmF0YXItZWRpdFwiKTtcclxuY29uc3QgYXZhdGFyRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fYXZhdGFyXCIpO1xyXG5jb25zdCBhdmF0YXJFZGl0QnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19hdmF0YXItYnRuXCIpO1xyXG5jb25zdCBhdmF0YXJGb3JtID0gYXZhdGFyTW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fZm9ybVwiKTtcclxuY29uc3QgYXZhdGFySW5wdXQgPSBhdmF0YXJNb2RhbC5xdWVyeVNlbGVjdG9yKFxyXG4gIFwiI21vZGFsLWF2YXRhci1kZXNjcmlwdGlvbi1pbnB1dFwiXHJcbik7XHJcbmNvbnN0IGF2YXRhclN1Ym1pdEJ0biA9IGF2YXRhck1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX3N1Ym1pdC1idG5cIik7XHJcbmNvbnN0IGF2YXRhck1vZGFsQ2xvc2VCdG4gPSBhdmF0YXJNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19jbG9zZS1idG5cIik7XHJcblxyXG5jb25zdCBkZWxldGVNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjbW9kYWxfX2RlbGV0ZVwiKTtcclxuY29uc3QgZGVsZXRlRm9ybSA9IGRlbGV0ZU1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Zvcm1cIik7XHJcblxyXG5jb25zdCBwcmV2aWV3TW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI21vZGFsX19wcmV2aWV3XCIpO1xyXG5jb25zdCBwcmV2aWV3TW9kYWxJbWFnZUVsID0gcHJldmlld01vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2ltYWdlXCIpO1xyXG5jb25zdCBwcmV2aWV3TW9kYWxDYXB0aW9uRWwgPSBwcmV2aWV3TW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fY2FwdGlvblwiKTtcclxuY29uc3QgcHJldmlld01vZGFsQ2xvc2VCdG4gPSBwcmV2aWV3TW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fY2xvc2UtYnRuXCIpO1xyXG5cclxuY29uc3QgY2FyZFRlbXBsYXRlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNjYXJkLXRlbXBsYXRlXCIpO1xyXG5jb25zdCBjYXJkc0xpc3QgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRzX19saXN0XCIpO1xyXG5cclxubGV0IGN1cnJlbnRNb2RhbCA9IG51bGw7XHJcblxyXG5sZXQgc2VsZWN0ZWRDYXJkO1xyXG5sZXQgc2VsZWN0ZWRDYXJkSWQ7XHJcblxyXG5mdW5jdGlvbiBoYW5kbGVFc2NLZXkoZXZ0KSB7XHJcbiAgaWYgKGV2dC5rZXkgPT09IFwiRXNjYXBlXCIgJiYgY3VycmVudE1vZGFsKSB7XHJcbiAgICBjbG9zZU1vZGFsKGN1cnJlbnRNb2RhbCk7XHJcbiAgfVxyXG59XHJcblxyXG5mdW5jdGlvbiBoYW5kbGVPdXRzaWRlQ2xpY2soZXZ0KSB7XHJcbiAgaWYgKGN1cnJlbnRNb2RhbCAmJiBldnQudGFyZ2V0ID09PSBjdXJyZW50TW9kYWwpIHtcclxuICAgIGNsb3NlTW9kYWwoY3VycmVudE1vZGFsKTtcclxuICB9XHJcbn1cclxuXHJcbmZ1bmN0aW9uIG9wZW5Nb2RhbChtb2RhbCkge1xyXG4gIG1vZGFsLmNsYXNzTGlzdC5hZGQoXCJtb2RhbF9vcGVuZWRcIik7XHJcbiAgY3VycmVudE1vZGFsID0gbW9kYWw7XHJcbiAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgaGFuZGxlRXNjS2V5KTtcclxuICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgaGFuZGxlT3V0c2lkZUNsaWNrKTtcclxuICBjb25zb2xlLmxvZyhcIk1vZGFsIG9wZW5lZCBhbmQgRXNjYXBlIGtleSBsaXN0ZW5lciBhZGRlZFwiKTtcclxufVxyXG5cclxuZnVuY3Rpb24gY2xvc2VNb2RhbChtb2RhbCkge1xyXG4gIG1vZGFsLmNsYXNzTGlzdC5yZW1vdmUoXCJtb2RhbF9vcGVuZWRcIik7XHJcbiAgaWYgKGN1cnJlbnRNb2RhbCA9PT0gbW9kYWwpIHtcclxuICAgIGN1cnJlbnRNb2RhbCA9IG51bGw7XHJcbiAgfVxyXG4gIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIGhhbmRsZUVzY0tleSk7XHJcbiAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGhhbmRsZU91dHNpZGVDbGljayk7XHJcbiAgY29uc29sZS5sb2coXCJNb2RhbCBjbG9zZWQgYW5kIEVzY2FwZSBrZXkgbGlzdGVuZXIgcmVtb3ZlZFwiKTtcclxufVxyXG5jb25zdCBjbG9zZUJ1dHRvbnMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLm1vZGFsX19jbG9zZS1idG5cIik7XHJcblxyXG5jbG9zZUJ1dHRvbnMuZm9yRWFjaCgoYnV0dG9uKSA9PiB7XHJcbiAgY29uc3QgbW9kYWwgPSBidXR0b24uY2xvc2VzdChcIi5tb2RhbFwiKTtcclxuXHJcbiAgYnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiBjbG9zZU1vZGFsKG1vZGFsKSk7XHJcbn0pO1xyXG5cclxuZnVuY3Rpb24gaGFuZGxlRGVsZXRlQ2FyZChjYXJkRWxlbWVudCwgY2FyZElkKSB7XHJcbiAgc2VsZWN0ZWRDYXJkID0gY2FyZEVsZW1lbnQ7XHJcbiAgc2VsZWN0ZWRDYXJkSWQgPSBjYXJkSWQ7XHJcbiAgb3Blbk1vZGFsKGRlbGV0ZU1vZGFsKTtcclxufVxyXG5cclxuZnVuY3Rpb24gZ2V0Q2FyZEVsZW1lbnQoZGF0YSkge1xyXG4gIGNvbnN0IGNhcmRFbGVtZW50ID0gY2FyZFRlbXBsYXRlLmNvbnRlbnRcclxuICAgIC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRcIilcclxuICAgIC5jbG9uZU5vZGUodHJ1ZSk7XHJcbiAgY29uc3QgY2FyZE5hbWVFbCA9IGNhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fdGl0bGVcIik7XHJcbiAgY29uc3QgY2FyZEltYWdlRWwgPSBjYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2ltYWdlXCIpO1xyXG4gIGNvbnN0IGNhcmRMaWtlQnRuID0gY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19saWtlLWJ0blwiKTtcclxuICBjb25zdCBjYXJkRGVsZXRlQnRuID0gY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19kZWxldGUtYnRuXCIpO1xyXG5cclxuICBjYXJkTmFtZUVsLnRleHRDb250ZW50ID0gZGF0YS5uYW1lO1xyXG4gIGNhcmRJbWFnZUVsLnNyYyA9IGRhdGEubGluaztcclxuICBjYXJkSW1hZ2VFbC5hbHQgPSBkYXRhLm5hbWU7XHJcblxyXG4gIGlmIChkYXRhLmlzTGlrZWQpIHtcclxuICAgIGNhcmRMaWtlQnRuLmNsYXNzTGlzdC5hZGQoXCJjYXJkX19saWtlLWJ0bl9saWtlZFwiKTtcclxuICB9XHJcblxyXG4gIGZ1bmN0aW9uIGhhbmRsZUxpa2UoZXZ0LCBpZCkge1xyXG4gICAgY29uc3QgaXNMaWtlZCA9IGNhcmRMaWtlQnRuLmNsYXNzTGlzdC5jb250YWlucyhcImNhcmRfX2xpa2UtYnRuX2xpa2VkXCIpO1xyXG4gICAgYXBpXHJcbiAgICAgIC5jaGFuZ2VMaWtlU3RhdHVzKGRhdGEuX2lkLCBpc0xpa2VkKVxyXG4gICAgICAudGhlbigocmVzKSA9PiB7XHJcbiAgICAgICAgY2FyZExpa2VCdG4uY2xhc3NMaXN0LnRvZ2dsZShcImNhcmRfX2xpa2UtYnRuX2xpa2VkXCIsIHJlcy5pc0xpa2VkKTtcclxuICAgICAgfSlcclxuICAgICAgLmNhdGNoKGNvbnNvbGUuZXJyb3IpO1xyXG4gIH1cclxuXHJcbiAgY2FyZExpa2VCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGhhbmRsZUxpa2UpO1xyXG5cclxuICBjYXJkSW1hZ2VFbC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gICAgb3Blbk1vZGFsKHByZXZpZXdNb2RhbCk7XHJcbiAgICBwcmV2aWV3TW9kYWxJbWFnZUVsLnNyYyA9IGRhdGEubGluaztcclxuICAgIHByZXZpZXdNb2RhbENhcHRpb25FbC50ZXh0Q29udGVudCA9IGRhdGEubmFtZTtcclxuICAgIHByZXZpZXdNb2RhbEltYWdlRWwuYWx0ID0gZGF0YS5uYW1lO1xyXG4gIH0pO1xyXG5cclxuICBjYXJkRGVsZXRlQnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZXZ0KSA9PiB7XHJcbiAgICBoYW5kbGVEZWxldGVDYXJkKGNhcmRFbGVtZW50LCBkYXRhLl9pZCk7XHJcbiAgfSk7XHJcblxyXG4gIHJldHVybiBjYXJkRWxlbWVudDtcclxufVxyXG5cclxuZnVuY3Rpb24gaGFuZGxlRWRpdEZvclN1Ym1pdChlKSB7XHJcbiAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG5cclxuICBjb25zdCBzdWJtaXRCdG4gPSBlLnN1Ym1pdHRlcjtcclxuICBzZXRCdXR0b25UZXh0KHN1Ym1pdEJ0biwgdHJ1ZSk7XHJcblxyXG4gIGFwaVxyXG4gICAgLmVkaXRVc2VySW5mbyh7XHJcbiAgICAgIG5hbWU6IGVkaXRNb2RhbE5hbWVJbnB1dC52YWx1ZSxcclxuICAgICAgYWJvdXQ6IGVkaXRNb2RhbERlc2NyaXB0aW9uSW5wdXQudmFsdWUsXHJcbiAgICB9KVxyXG4gICAgLnRoZW4oKGRhdGEpID0+IHtcclxuICAgICAgcHJvZmlsZU5hbWUudGV4dENvbnRlbnQgPSBkYXRhLm5hbWU7XHJcbiAgICAgIHByb2ZpbGVEZXNjcmlwdGlvbi50ZXh0Q29udGVudCA9IGRhdGEuYWJvdXQ7XHJcbiAgICAgIGNsb3NlTW9kYWwoZWRpdE1vZGFsKTtcclxuICAgIH0pXHJcbiAgICAuY2F0Y2goY29uc29sZS5lcnJvcilcclxuICAgIC5maW5hbGx5KCgpID0+IHtcclxuICAgICAgc2V0QnV0dG9uVGV4dChzdWJtaXRCdG4sIGZhbHNlKTtcclxuICAgIH0pO1xyXG59XHJcblxyXG5mdW5jdGlvbiBoYW5kbGVBZGRDYXJkU3VibWl0KGUpIHtcclxuICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgY29uc3QgaW5wdXRWYWx1ZXMgPSB7IG5hbWU6IGNhcmROYW1lSW5wdXQudmFsdWUsIGxpbms6IGNhcmRMaW5rSW5wdXQudmFsdWUgfTtcclxuXHJcbiAgY29uc3Qgc3VibWl0QnRuID0gZS5zdWJtaXR0ZXI7XHJcbiAgc2V0QnV0dG9uVGV4dChzdWJtaXRCdG4sIHRydWUpO1xyXG5cclxuICBhcGlcclxuICAgIC5hZGROZXdDYXJkKGlucHV0VmFsdWVzKVxyXG4gICAgLnRoZW4oKGRhdGEpID0+IHtcclxuICAgICAgY29uc3QgY2FyZEVsZW1lbnQgPSBnZXRDYXJkRWxlbWVudChkYXRhKTtcclxuICAgICAgY2FyZHNMaXN0LnByZXBlbmQoY2FyZEVsZW1lbnQpO1xyXG4gICAgICBlLnRhcmdldC5yZXNldCgpO1xyXG4gICAgICBkaXNhYmxlQnV0dG9uKGNhcmRTdWJtaXRCdG4sIHNldHRpbmdzKTtcclxuICAgICAgY2xvc2VNb2RhbChjYXJkTW9kYWwpO1xyXG4gICAgfSlcclxuICAgIC5jYXRjaChjb25zb2xlLmVycm9yKVxyXG4gICAgLmZpbmFsbHkoKCkgPT4ge1xyXG4gICAgICBzZXRCdXR0b25UZXh0KHN1Ym1pdEJ0biwgZmFsc2UpO1xyXG4gICAgfSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGhhbmRsZURlbGV0ZVN1Ym1pdChldnQpIHtcclxuICBldnQucHJldmVudERlZmF1bHQoKTtcclxuXHJcbiAgY29uc3Qgc3VibWl0QnRuID0gZXZ0LnN1Ym1pdHRlcjtcclxuICBzZXRCdXR0b25UZXh0KHN1Ym1pdEJ0biwgdHJ1ZSwgXCJkZWxldGVcIiwgXCJkZWxldGluZy4uLlwiKTtcclxuICBhcGlcclxuICAgIC5kZWxldGVDYXJkKHNlbGVjdGVkQ2FyZElkKVxyXG4gICAgLnRoZW4oKCkgPT4ge1xyXG4gICAgICBzZWxlY3RlZENhcmQucmVtb3ZlKCk7XHJcbiAgICAgIHNlbGVjdGVkQ2FyZCA9IG51bGw7XHJcbiAgICAgIHNlbGVjdGVkQ2FyZElkID0gbnVsbDtcclxuICAgICAgY2xvc2VNb2RhbChkZWxldGVNb2RhbCk7XHJcbiAgICB9KVxyXG4gICAgLmNhdGNoKGNvbnNvbGUuZXJyb3IpXHJcbiAgICAuZmluYWxseSgoKSA9PiB7XHJcbiAgICAgIHNldEJ1dHRvblRleHQoc3VibWl0QnRuLCBmYWxzZSwgXCJkZWxldGVcIik7XHJcbiAgICB9KTtcclxufVxyXG5cclxuZnVuY3Rpb24gaGFuZGxlQXZhdGFyU3VibWl0KGV2dCkge1xyXG4gIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xyXG5cclxuICBjb25zdCBzdWJtaXRCdG4gPSBldnQuc3VibWl0dGVyO1xyXG4gIHNldEJ1dHRvblRleHQoc3VibWl0QnRuLCB0cnVlKTtcclxuICBhcGlcclxuICAgIC5lZGl0QXZhdGFySW5mbyhhdmF0YXJJbnB1dC52YWx1ZSlcclxuICAgIC50aGVuKChkYXRhKSA9PiB7XHJcbiAgICAgIGNvbnNvbGUubG9nKGRhdGEpO1xyXG5cclxuICAgICAgaWYgKGRhdGEuYXZhdGFyKSB7XHJcbiAgICAgICAgYXZhdGFyRWxlbWVudC5zcmMgPSBkYXRhLmF2YXRhcjtcclxuICAgICAgICBhdmF0YXJFbGVtZW50LmFsdCA9IFwiVXBkYXRlZCBBdmF0YXJcIjtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKFwiQXZhdGFyIFVSTCBub3QgZm91bmQgaW4gdGhlIHJlc3BvbnNlXCIpO1xyXG4gICAgICB9XHJcblxyXG4gICAgICBjbG9zZU1vZGFsKGF2YXRhck1vZGFsKTtcclxuXHJcbiAgICAgIGF2YXRhckZvcm0ucmVzZXQoKTtcclxuICAgIH0pXHJcbiAgICAuY2F0Y2goY29uc29sZS5lcnJvcilcclxuICAgIC5maW5hbGx5KCgpID0+IHtcclxuICAgICAgc2V0QnV0dG9uVGV4dChzdWJtaXRCdG4sIGZhbHNlKTtcclxuICAgIH0pO1xyXG59XHJcblxyXG5wcm9maWxlRWRpdEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gIGVkaXRNb2RhbE5hbWVJbnB1dC52YWx1ZSA9IHByb2ZpbGVOYW1lLnRleHRDb250ZW50O1xyXG4gIGVkaXRNb2RhbERlc2NyaXB0aW9uSW5wdXQudmFsdWUgPSBwcm9maWxlRGVzY3JpcHRpb24udGV4dENvbnRlbnQ7XHJcbiAgcmVzZXRWYWxpZGF0aW9uKFxyXG4gICAgcHJvZmlsZUZvcm0sXHJcbiAgICBbZWRpdE1vZGFsTmFtZUlucHV0LCBlZGl0TW9kYWxEZXNjcmlwdGlvbklucHV0XSxcclxuICAgIHNldHRpbmdzXHJcbiAgKTtcclxuICBvcGVuTW9kYWwoZWRpdE1vZGFsKTtcclxufSk7XHJcblxyXG5jYXJkTW9kYWxidG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICBlZGl0TW9kYWxOYW1lSW5wdXQudmFsdWUgPSBwcm9maWxlTmFtZS50ZXh0Q29udGVudDtcclxuICBlZGl0TW9kYWxEZXNjcmlwdGlvbklucHV0LnZhbHVlID0gcHJvZmlsZURlc2NyaXB0aW9uLnRleHRDb250ZW50O1xyXG4gIG9wZW5Nb2RhbChjYXJkTW9kYWwpO1xyXG59KTtcclxuXHJcbmF2YXRhckVkaXRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICBvcGVuTW9kYWwoYXZhdGFyTW9kYWwpO1xyXG59KTtcclxuXHJcbmF2YXRhckZvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCBoYW5kbGVBdmF0YXJTdWJtaXQpO1xyXG5cclxucHJvZmlsZUZvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCBoYW5kbGVFZGl0Rm9yU3VibWl0KTtcclxuY2FyZEZvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCBoYW5kbGVBZGRDYXJkU3VibWl0KTtcclxuZGVsZXRlRm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIGhhbmRsZURlbGV0ZVN1Ym1pdCk7XHJcbmNhbmNlbEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4gY2xvc2VNb2RhbChkZWxldGVNb2RhbCkpO1xyXG5cclxuZW5hYmxlVmFsaWRhdGlvbihzZXR0aW5ncyk7XHJcbiIsImNsYXNzIEFwaSB7XHJcbiAgY29uc3RydWN0b3IoeyBiYXNlVXJsLCBoZWFkZXJzIH0pIHtcclxuICAgIHRoaXMuX2Jhc2VVcmwgPSBiYXNlVXJsO1xyXG4gICAgdGhpcy5faGVhZGVycyA9IGhlYWRlcnM7XHJcbiAgfVxyXG5cclxuICBnZXRBcHBJbmZvKCkge1xyXG4gICAgcmV0dXJuIFByb21pc2UuYWxsKFt0aGlzLmdldEluaXRpYWxDYXJkcygpLCB0aGlzLmdldFVzZXJJbmZvKCldKTtcclxuICB9XHJcblxyXG4gIGdldEluaXRpYWxDYXJkcygpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkc2AsIHtcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgIH0pLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgICBpZiAocmVzLm9rKSB7XHJcbiAgICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XHJcbiAgICAgIH1cclxuICAgICAgUHJvbWlzZS5yZWplY3QoYEVycm9yOiAke3Jlcy5zdGF0dXN9YCk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIGdldFVzZXJJbmZvKCkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lYCwge1xyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgfSkudGhlbigocmVzKSA9PiB7XHJcbiAgICAgIGlmIChyZXMub2spIHtcclxuICAgICAgICByZXR1cm4gcmVzLmpzb24oKTtcclxuICAgICAgfVxyXG4gICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYEVycm9yOiAke3Jlcy5zdGF0dXN9YCk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIGFkZE5ld0NhcmQoeyBuYW1lLCBsaW5rIH0pIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkc2AsIHtcclxuICAgICAgbWV0aG9kOiBcIlBPU1RcIixcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xyXG4gICAgICAgIG5hbWUsXHJcbiAgICAgICAgbGluayxcclxuICAgICAgfSksXHJcbiAgICB9KS50aGVuKChyZXMpID0+IHtcclxuICAgICAgaWYgKHJlcy5vaykge1xyXG4gICAgICAgIHJldHVybiByZXMuanNvbigpO1xyXG4gICAgICB9XHJcbiAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChgRXJyb3I6ICR7cmVzLnN0YXR1c31gKTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgZWRpdFVzZXJJbmZvKHsgbmFtZSwgYWJvdXQgfSkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lYCwge1xyXG4gICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuXHJcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcclxuICAgICAgICBuYW1lLFxyXG4gICAgICAgIGFib3V0LFxyXG4gICAgICB9KSxcclxuICAgIH0pLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgICBpZiAocmVzLm9rKSB7XHJcbiAgICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XHJcbiAgICAgIH1cclxuICAgICAgUHJvbWlzZS5yZWplY3QoYEVycm9yOiAke3Jlcy5zdGF0dXN9YCk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIGVkaXRBdmF0YXJJbmZvKGF2YXRhcikge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lL2F2YXRhcmAsIHtcclxuICAgICAgbWV0aG9kOiBcIlBBVENIXCIsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcclxuICAgICAgICBhdmF0YXIsXHJcbiAgICAgIH0pLFxyXG4gICAgfSkudGhlbigocmVzKSA9PiB7XHJcbiAgICAgIGlmIChyZXMub2spIHtcclxuICAgICAgICByZXR1cm4gcmVzLmpzb24oKTtcclxuICAgICAgfVxyXG4gICAgICBQcm9taXNlLnJlamVjdChgRXJyb3I6ICR7cmVzLnN0YXR1c31gKTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgZGVsZXRlQ2FyZChpZCkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzLyR7aWR9YCwge1xyXG4gICAgICBtZXRob2Q6IFwiREVMRVRFXCIsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICB9KS50aGVuKChyZXMpID0+IHtcclxuICAgICAgaWYgKHJlcy5vaykge1xyXG4gICAgICAgIHJldHVybiByZXMuanNvbigpO1xyXG4gICAgICB9XHJcbiAgICAgIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBjaGFuZ2VMaWtlU3RhdHVzKGlkLCBpc0xpa2VkKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHMvJHtpZH0vbGlrZXNgLCB7XHJcbiAgICAgIG1ldGhvZDogaXNMaWtlZCA/IFwiREVMRVRFXCIgOiBcIlBVVFwiLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgfSkudGhlbigocmVzKSA9PiB7XHJcbiAgICAgIGlmIChyZXMub2spIHtcclxuICAgICAgICByZXR1cm4gcmVzLmpzb24oKTtcclxuICAgICAgfVxyXG4gICAgICBQcm9taXNlLnJlamVjdChgRXJyb3I6ICR7cmVzLnN0YXR1c31gKTtcclxuICAgIH0pO1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgQXBpO1xyXG4iXSwibmFtZXMiOlsic2V0dGluZ3MiLCJmb3JtU2VsZWN0b3IiLCJpbnB1dFNlbGVjdG9yIiwic3VibWl0QnV0dG9uU2VsZWN0b3IiLCJpbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiaW5wdXRFcnJvckNsYXNzIiwiZXJyb3JDbGFzcyIsImRpc2FibGVCdXR0b24iLCJidXR0b25FbCIsImNvbmZpZyIsImRpc2FibGVkIiwiY2xhc3NMaXN0IiwiYWRkIiwidG9nZ2xlQnV0dG9uU3RhdGUiLCJpbnB1dExpc3QiLCJzb21lIiwiaW5wdXQiLCJ2YWxpZGl0eSIsInZhbGlkIiwiaGFzSW52YWxpZElucHV0IiwiZW5hYmxlQnV0dG9uIiwicmVtb3ZlIiwiaGlkZUlucHV0RXJyb3IiLCJmb3JtRWwiLCJpbnB1dEVsIiwicXVlcnlTZWxlY3RvciIsImlkIiwidGV4dENvbnRlbnQiLCJzZXRCdXR0b25UZXh0IiwiYnRuIiwiaXNMb2FkaW5nIiwiZGVmYXVsdFRleHQiLCJhcmd1bWVudHMiLCJsZW5ndGgiLCJ1bmRlZmluZWQiLCJsb2FkaW5nVGV4dCIsImNvbnNvbGUiLCJsb2ciLCJuYW1lIiwibGluayIsImFwaSIsImNvbnN0cnVjdG9yIiwiX3JlZiIsImJhc2VVcmwiLCJoZWFkZXJzIiwidGhpcyIsIl9iYXNlVXJsIiwiX2hlYWRlcnMiLCJnZXRBcHBJbmZvIiwiUHJvbWlzZSIsImFsbCIsImdldEluaXRpYWxDYXJkcyIsImdldFVzZXJJbmZvIiwiZmV0Y2giLCJ0aGVuIiwicmVzIiwib2siLCJqc29uIiwicmVqZWN0Iiwic3RhdHVzIiwiYWRkTmV3Q2FyZCIsIl9yZWYyIiwibWV0aG9kIiwiYm9keSIsIkpTT04iLCJzdHJpbmdpZnkiLCJlZGl0VXNlckluZm8iLCJfcmVmMyIsImFib3V0IiwiZWRpdEF2YXRhckluZm8iLCJhdmF0YXIiLCJkZWxldGVDYXJkIiwiY2hhbmdlTGlrZVN0YXR1cyIsImlzTGlrZWQiLCJhdXRob3JpemF0aW9uIiwiY2FyZHMiLCJ1c2VySW5mbyIsImZvckVhY2giLCJjYXJkIiwiY2FyZEVsZW1lbnQiLCJnZXRDYXJkRWxlbWVudCIsImNhcmRzTGlzdCIsInByZXBlbmQiLCJwcm9maWxlTmFtZSIsInByb2ZpbGVEZXNjcmlwdGlvbiIsImRvY3VtZW50Iiwic3JjIiwiY2F0Y2giLCJlcnJvciIsInByb2ZpbGVGb3JtIiwiZm9ybXMiLCJjYXJkRm9ybSIsInByb2ZpbGVFZGl0QnV0dG9uIiwiY2FyZE1vZGFsYnRuIiwiY2FyZFN1Ym1pdEJ0biIsImNhbmNlbEJ1dHRvbiIsImVkaXRNb2RhbCIsImVkaXRNb2RhbE5hbWVJbnB1dCIsImVkaXRNb2RhbERlc2NyaXB0aW9uSW5wdXQiLCJjYXJkTW9kYWwiLCJjYXJkTmFtZUlucHV0IiwiY2FyZExpbmtJbnB1dCIsImF2YXRhck1vZGFsIiwiZ2V0RWxlbWVudEJ5SWQiLCJhdmF0YXJFbGVtZW50IiwiYXZhdGFyRWRpdEJ1dHRvbiIsImF2YXRhckZvcm0iLCJhdmF0YXJJbnB1dCIsImRlbGV0ZU1vZGFsIiwiZGVsZXRlRm9ybSIsInByZXZpZXdNb2RhbCIsInByZXZpZXdNb2RhbEltYWdlRWwiLCJwcmV2aWV3TW9kYWxDYXB0aW9uRWwiLCJjYXJkVGVtcGxhdGUiLCJzZWxlY3RlZENhcmQiLCJzZWxlY3RlZENhcmRJZCIsImN1cnJlbnRNb2RhbCIsImhhbmRsZUVzY0tleSIsImV2dCIsImtleSIsImNsb3NlTW9kYWwiLCJoYW5kbGVPdXRzaWRlQ2xpY2siLCJ0YXJnZXQiLCJvcGVuTW9kYWwiLCJtb2RhbCIsImFkZEV2ZW50TGlzdGVuZXIiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwiZGF0YSIsImNvbnRlbnQiLCJjbG9uZU5vZGUiLCJjYXJkTmFtZUVsIiwiY2FyZEltYWdlRWwiLCJjYXJkTGlrZUJ0biIsImNhcmREZWxldGVCdG4iLCJhbHQiLCJjb250YWlucyIsIl9pZCIsInRvZ2dsZSIsImNhcmRJZCIsImhhbmRsZURlbGV0ZUNhcmQiLCJxdWVyeVNlbGVjdG9yQWxsIiwiYnV0dG9uIiwiY2xvc2VzdCIsInJlc2V0VmFsaWRhdGlvbiIsInZhbHVlIiwicHJldmVudERlZmF1bHQiLCJzdWJtaXRCdG4iLCJzdWJtaXR0ZXIiLCJyZXNldCIsImZpbmFsbHkiLCJlIiwiaW5wdXRWYWx1ZXMiLCJBcnJheSIsImZyb20iLCJzZXRFdmVudExpc3RuZXJzIiwiYnV0dG9uRWxlbWVudCIsImlucHV0RWxlbWVudCIsImNoZWNrSW5wdXRWYWxpZGl0eSIsInNob3dJbnB1dEVycm9yIiwiZXJyb3JNc2ciLCJ2YWxpZGF0aW9uTWVzc2FnZSJdLCJzb3VyY2VSb290IjoiIn0=